# Tóm Tắt Thiết Kế Hệ Thống Review Code AI & RAG

| Thành phần chính | Mô tả chức năng | Công nghệ/Kỹ thuật nổi bật | Tối ưu hóa liên quan |
|---|---|---|---|
| **Frontend (Web UI)** | Giao diện tương tác cho người dùng tải file/dán code, hỗ trợ chọn danh mục review (bảo mật, clean code, v.v.) qua checkbox. **Hiển thị báo cáo review dưới dạng bảng trên web và cung cấp nút tải xuống file Excel.** | React.js, Tailwind CSS, API FileReader, Thư viện tạo bảng (ví dụ: React Table), Thư viện xuất Excel (ví dụ: SheetJS) | Giao diện thân thiện, hỗ trợ đa file, tùy chỉnh phạm vi review, dễ dàng xem và xuất dữ liệu. |
| **Backend (API Server)** | Điều phối luồng review, xử lý input (hỗ trợ đa file và danh mục review đã chọn), tương tác với RAG/LLM. Định dạng output dưới dạng Markdown và **cung cấp dữ liệu dạng cấu trúc (ví dụ: JSON) để Frontend hiển thị bảng và tạo file Excel.** | Python (FastAPI/Flask) | Xử lý song song (concurrency) cho nhiều file, tiền lọc quy tắc đơn giản, lọc quy tắc theo danh mục, chuẩn bị dữ liệu linh hoạt cho nhiều định dạng xuất. |
| **RAG/LLM Core** | Bộ não hệ thống: chứa cơ sở dữ liệu vector, mô hình embedding và mô hình ngôn ngữ lớn (LLM). | ChromaDB (qua Docker), Embedding Model (Ollama), LLM (Ollama Phi4) | RAG cung cấp ngữ cảnh, LLM nhỏ gọn (Phi4), chất lượng dữ liệu RAG. |
| **Dữ liệu RAG: Codebase** | Lưu trữ cấu trúc và ngữ nghĩa của toàn bộ codebase để LLM tham chiếu. | AST (Abstract Syntax Tree), Chunking, Embedding | Phân tích AST giúp truy vấn chính xác, chunking tối ưu token. |
| **Dữ liệu RAG: Checklist** | Chứa các quy tắc review cụ thể dưới dạng JSON để LLM áp dụng. Các quy tắc được gán với các danh mục (category) tương ứng. | File \*.json, Embedding | Quy tắc rõ ràng, không mâu thuẫn, hỗ trợ lọc theo danh mục. |
| **Quy trình Review Input** | Nhận file code hoặc đoạn code cần review, các danh mục review được chọn, phân tích AST và chia nhỏ (chunking). | FileReader (Frontend), AST parsing (Backend) | Xử lý từng file riêng lẻ rồi tổng hợp kết quả, chỉ xử lý các danh mục được chọn. |
| **Quy trình Truy vấn RAG** | Lấy về các quy tắc liên quan từ Checklist (chỉ những quy tắc thuộc các danh mục đã chọn) và các đoạn code mẫu từ Codebase. | Truy vấn ChromaDB (embedding similarity, có thể thêm lọc metadata theo category) | Đánh giá độ tương đồng để lấy thông tin liên quan nhất, tập trung vào các danh mục đã chọn. |
| **Quy trình Xây dựng Prompt** | Tạo prompt rõ ràng, cấu trúc cho LLM với code input, các quy tắc thuộc danh mục đã chọn, ngữ cảnh và yêu cầu đề xuất fix. | Prompt Engineering | Prompt chặt chẽ giúp giảm ảo giác, tăng độ chính xác, hướng dẫn LLM tập trung vào các khía cạnh mong muốn. |
| **Quy trình Output** | LLM trả về kết quả Markdown cho từng file/đoạn code. Backend tổng hợp và chuẩn bị dữ liệu. Frontend hiển thị kết quả trên web dạng bảng với trạng thái vi phạm/không, đề xuất sửa lỗi nếu có vi phạm, và các quy tắc được đánh số thứ tự. Người dùng có thể tải xuống file Excel. | Định dạng Markdown (từ LLM), Cấu trúc JSON (từ Backend), Hiển thị bảng trên Frontend, Xuất Excel (Frontend) | Tổng hợp báo cáo chung cho nhiều file, định dạng rõ ràng, trực quan trên web và có thể lưu trữ. |
| **Giảm thiểu Ảo giác** | Đảm bảo LLM chỉ sử dụng thông tin được cung cấp, không suy diễn. | Prompt Engineering, Chất lượng dữ liệu RAG, Ngưỡng tương đồng RAG | Các ràng buộc trong prompt, dữ liệu RAG chuẩn xác. |
